---
title: "TIF Data Iowa visualization"
author: "Vaishnavi Devi Kondabathini"
date: "2026-01-09" 
output:
  md_document:
    variant: gfm
output_file: "README.md"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(maps)
library(tidyverse)
library(dplyr)
library(scales)
```

Here, I am using creating csv data file for the Tax increament finance (TIF)

```{r}
# Load the correct library for Excel files
library(readxl)

# Use read_excel instead of read_csv for .xlsx files
TIF_data_Iowa <- read_excel("C:/Users/vaish/Downloads/TIF data Iowa.xlsx")

# Now it should show the data table as separate page
View(TIF_data_Iowa)


summary(TIF_data_Iowa)

#colnames(TIF_data_Iowa)

#names(TIF_data_Iowa)

#dim(TIF_data_Iowa)

#head(TIF_data_Iowa)

#glimpse(TIF_data_Iowa)
```

here I have made graph for Assessment Year, Estimated Revenue ($ Millions) which can readable and understandable.

```{r}
final_plot_data <- TIF_data_Iowa %>%
  filter(!is.na(...1))

ggplot(final_plot_data,
       aes(x = as.numeric(...1),
           y = `Estimated TIF Revenues ($ Millions)`)) +
  geom_line(color = "#2c3e50", linewidth = 1.2) +
  geom_point(color = "#e74c3c", size = 3) +
  theme_minimal() +
  scale_y_continuous(labels = label_dollar()) +
  scale_x_continuous(breaks = seq(2000, 2021, by = 2)) +
  labs(
    title = "Projected TIF Revenues Over Time",
    subtitle = "Iowa Urban Renewal Analysis (2000-2021)",
    x = "Assessment Year",
    y = "Estimated Revenue ($ Millions)",
    caption = "Source: TIF data Iowa"
  ) +
  theme(plot.title = element_text(face = "bold", size = 14))
```

can you create the base year graph by compare with each year.

```{r}
# Load the tidyverse library for data manipulation and clean tables
library(tidyverse)

# Create the data frame based on the provided images
tif_table <- tibble(
  Base_Year = c(
    "1981", "1982", "1983", "1984", "1985", "1986", "1987", "1988", "1989", "1990",
    "1991", "1992", "1993", "1994", "1995", "1996", "1997", "1998", "1999", "2000",
    "2001", "2002", "2003", "2004", "2005", "2006", "2007", "2008", "2009", "2010",
    "2011", "2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019", "2020*", "2021*"
  ),
  Count = c(
    1, 3, 4, 3, 10, 11, 22, 37, 40, 40, 26, 56, 80, 39, 17, 19, 13, 9, 29, 34,
    38, 70, 46, 38, 35, 46, 56, 56, 53, 76, 65, 87, 72, 71, 88, 81, 102, 107, 109, 89, 8
  ),
  Frozen_Base_Valuation_Millions = c(
    1.80, 123.00, 42.40, 20.20, 57.30, 40.90, 258.80, 446.60, 271.20, 327.70,
    162.40, 489.60, 532.50, 213.30, 53.40, 213.80, 100.30, 173.10, 803.20, 215.90,
    96.30, 577.00, 191.50, 297.60, 158.10, 390.80, 339.50, 146.20, 394.70, 654.40,
    536.50, 147.80, 209.10, 504.10, 449.90, 1228.80, 629.50, 405.60, 127.00, 216.70, 52.30
  ),
  Incremental_Valuation_Millions = c(
    3.60, 311.30, 81.00, 20.50, 81.30, 165.70, 407.80, 913.10, 684.50, 388.90,
    384.90, 884.80, 801.30, 213.60, 48.30, 172.60, 154.90, 160.50, 492.20, 491.10,
    136.40, 518.10, 227.60, 204.10, 138.00, 393.50, 379.20, 440.40, 308.90, 243.10,
    190.80, 526.20, 432.30, 366.00, 518.40, 510.70, 531.30, 756.90, 364.60, 131.90, 2.40
  ),
  TIF_Estimated_Revenues_Millions = c(
    0.10, 11.70, 2.50, 0.50, 2.60, 5.30, 12.90, 26.90, 19.90, 11.10,
    11.20, 28.10, 23.10, 6.10, 1.40, 4.20, 4.40, 5.30, 15.30, 14.80,
    3.60, 14.90, 6.20, 6.10, 4.00, 10.20, 10.10, 9.60, 7.70, 6.00,
    5.60, 13.80, 11.60, 11.10, 14.90, 15.10, 13.00, 20.00, 9.00, 2.10, 0.02
  )
)

# View the table
print(tif_table)

# Optional: View as an interactive spreadsheet in RStudio
#View(tif_table)
```

```{r}
# Load necessary libraries
library(ggplot2)
library(dplyr)
```

The above graph is count and TIF Estimated Revenues ($ Millions) with bar graph.

```{r}
# 1. Prepare the dataset (Data sourced from provided tables)
tif_data <- data.frame(
  Year = 1981:2021,
  Count = c(1, 3, 4, 3, 10, 11, 22, 37, 40, 40, 26, 56, 80, 39, 17, 19, 13, 9, 29, 34, 
            38, 70, 46, 38, 35, 46, 56, 56, 53, 76, 65, 87, 72, 71, 88, 81, 102, 107, 109, 89, 8),
  Revenue = c(0.1, 11.7, 2.5, 0.5, 2.6, 5.3, 12.9, 26.9, 19.9, 11.1, 11.2, 28.1, 23.1, 6.1, 1.4, 
              4.2, 4.4, 5.3, 15.3, 14.8, 3.6, 14.9, 6.2, 6.1, 4.0, 10.2, 10.1, 9.6, 7.7, 6.0, 
              5.6, 13.8, 11.6, 11.1, 14.9, 15.1, 13.0, 20.0, 9.0, 2.1, 0.02)
)

# 2. Define the scaling factor for the second axis
# Since Count goes up to ~110 and Revenue to ~30, we multiply Revenue by 4 to align them
scale_factor <- 4

# 3. Create the Dual-Axis Visualization
ggplot(tif_data, aes(x = Year)) +
  # Bar chart for Project Count (Primary Axis)
  geom_bar(aes(y = Count), stat = "identity", fill = "#3498db", alpha = 0.3) +
  # Line chart for TIF Revenue (Scaled to fit the Primary Axis)
  geom_line(aes(y = Revenue * scale_factor), color = "#e74c3c", size = 1) +
  # Formatting the axes
  scale_y_continuous(
    name = "Count",
    sec.axis = sec_axis(~./scale_factor, name = "TIF Estimated Revenues ($ Millions)")
  ) +
  theme_minimal() +
  labs(
    title = "Project Count vs. TIF Revenue (1981-2021)",
    x = "Year"
  ) +
  theme(
    axis.title.y = element_text(color = "#3498db", face = "bold"),
    axis.title.y.right = element_text(color = "#e74c3c", face = "bold"),
    panel.grid.minor = element_blank()
  )
```

